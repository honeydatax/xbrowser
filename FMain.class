' Gambas class file

Public Function curls(ArgsCount As Integer, Args1 As String, Args2 As String) As String
  Dim s As Socket
  Dim ii As Integer
  Dim i As Integer
  Dim ss As String
  Dim sss As String
  Dim ssss As String
  s = New Socket
  sss = ""
  i = 80
  ss = "localhost"
  If ArgsCount > 1 Then ss = Args1
  If ArgsCount > 2 Then 
    sss = Args2
    i = Val(sss)
  Endif
  ss = Replace(ss, "http:", "")
  ss = Replace(ss, "//", "")
  ssss = ""
  ii = InStr(ss, "/")
  If ii > 0 Then
    ssss = Mid(ss, ii + 1)
    ss = Mid(ss, 1, ii - 1)
  Endif
  ss = Replace(ss, "/", "")
  s.Connect(ss, i)
  Do While (s.Status <> 7) And (s.Status > 0)
    Wait 0.1
  Loop
  sss = "GET /" & ssss & " HTTP/1.0\n\n"   
  If s.Status <> 7 Then Return "error"
  Write #s, sss, Len(sss)
  Do While Lof(s) = 0
    Wait 0.1
  Loop
  Read #s, sss, Lof(s)
  ii = InStr(sss, gb.CrLf & gb.Crlf)
  If ii > 0 Then
    sss = Mid(sss, ii + 4)
  Endif
  
  Return sss
  End

Public Sub _new()

End

Public Sub Form_Open()

End

Public Sub Button1_Click()
Dim v As String
Dim vv As String
Dim i As Integer
Dim ii As Integer
vv = ""
v = Replace(TextBox1.text, "http:", "")
v = Replace(v, "HTTP:", "")
v = Replace(v, "//", "")
i = InStr(v, ":")
ii = 2
vv = "80"
If i > 0 Then 
  ii = 3
  vv = Mid(v, i + 1)
  v = Mid(v, 1, i - 1)
  
Endif

vv = curls(ii, v, vv)
  i = InStr(vv, "<body>")
  If i < 1 Then i = InStr(vv, "<BODY>")
  If i > 0 Then 
    i = i + 6
    vv = Mid(vv, i, Len(vv) - i)
  Endif
  i = InStr(vv, "</body>")
  If i < 1 Then i = InStr(vv, "</BODY>")
  If i > 0 Then 
    vv = Mid(vv, 1, i - 1)
  Endif
  vv = Replace(vv, "<B>", Chr(13) & Chr(10))
  vv = Replace(vv, "</B>", Chr(13) & Chr(10))
  vv = Replace(vv, "<b>", Chr(13) & Chr(10))
  vv = Replace(vv, "</b>", Chr(13) & Chr(10))
  vv = Replace(vv, "<ul>", Chr(13) & Chr(10))
  vv = Replace(vv, "<tr>", Chr(13) & Chr(10))
  vv = Replace(vv, "</tr>", Chr(13) & Chr(10))
  vv = Replace(vv, "<TR>", Chr(13) & Chr(10))
  vv = Replace(vv, "<TR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</ul>", Chr(13) & Chr(10))
  vv = Replace(vv, "<UL>", Chr(13) & Chr(10))
  vv = Replace(vv, "</UL>", Chr(13) & Chr(10))
  vv = Replace(vv, "<li>", Chr(13) & Chr(10))
  vv = Replace(vv, "</li>", Chr(13) & Chr(10))
  vv = Replace(vv, "<LI>", Chr(13) & Chr(10))
  vv = Replace(vv, "</LI>", Chr(13) & Chr(10))
  vv = Replace(vv, "<a>", Chr(13) & Chr(10))
  vv = Replace(vv, "<A>", Chr(13) & Chr(10))
  vv = Replace(vv, "</a>", Chr(13) & Chr(10))
  vv = Replace(vv, "</A>", Chr(13) & Chr(10))
  vv = Replace(vv, "</A>", Chr(13) & Chr(10))
  vv = Replace(vv, "<br>", Chr(13) & Chr(10))
  vv = Replace(vv, "<BR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</br>", Chr(13) & Chr(10))
  vv = Replace(vv, "</BR>", Chr(13) & Chr(10))
  vv = Replace(vv, "</p>", Chr(13) & Chr(10))
  vv = Replace(vv, "</P>", Chr(13) & Chr(10))
  vv = Replace(vv, "<p>", Chr(13) & Chr(10))
  vv = Replace(vv, "<P>", Chr(13) & Chr(10))
  vv = Replace(vv, "<a href=", Chr(13) & Chr(10))
  vv = Replace(vv, "<A HREF=", Chr(13) & Chr(10))
  vv = Replace(vv, "<H1>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H2>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H3>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H4>", Chr(13) & Chr(10))
  vv = Replace(vv, "<H5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H1>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H2>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H3>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H4>", Chr(13) & Chr(10))
  vv = Replace(vv, "</H5>", Chr(13) & Chr(10))
vv = Replace(vv, "<h1>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h2>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h3>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h4>", Chr(13) & Chr(10))
  vv = Replace(vv, "<h5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h1>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h2>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h3>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h4>", Chr(13) & Chr(10))
  vv = Replace(vv, "</h5>", Chr(13) & Chr(10))
  vv = Replace(vv, "</i>", Chr(13) & Chr(10))
  vv = Replace(vv, "</I>", Chr(13) & Chr(10))
 vv = Replace(vv, "<i>", Chr(13) & Chr(10))
  vv = Replace(vv, "</I>", Chr(13) & Chr(10))
vv = Replace(vv, "<hr>", Chr(13) & Chr(10))
vv = Replace(vv, "</hr>", Chr(13) & Chr(10))
vv = Replace(vv, "</HR>", Chr(13) & Chr(10))
vv = Replace(vv, "<HR>", Chr(13) & Chr(10))
vv = Replace(vv, "<ui>", Chr(13) & Chr(10))
vv = Replace(vv, "</ui>", Chr(13) & Chr(10))
vv = Replace(vv, "<UI>", Chr(13) & Chr(10))
vv = Replace(vv, "</UI>", Chr(13) & Chr(10))
TextArea1.text = vv
End Sub

Public Sub Timer1_Timer()
End
